name: wercker-box-nodejs-latex
version: 1.0.0
description: Ubuntu 12.04 with NodeJs and texlive-full
inherits: wercker/ubuntu12.04-nodejs0.10@1.6.0
type: main
platform: ubuntu@12.04
keywords:
  - ubuntu
  - 12.04
  - latex
  - texlive
  - nodejs
script: |
  # https://wiki.ubuntu.com/ReducingDiskFootprint#Documentation
  sudo echo "path-exclude /usr/share/doc/*" >> /etc/dpkg/dpkg.cfg.d/01_nodoc
  sudo echo "path-include /usr/share/doc/*/copyright" >> /etc/dpkg/dpkg.cfg.d/01_nodoc
  sudo echo "path-exclude /usr/share/man/*" >> /etc/dpkg/dpkg.cfg.d/01_nodoc
  sudo echo "path-exclude /usr/share/groff/*" >> /etc/dpkg/dpkg.cfg.d/01_nodoc
  sudo echo "path-exclude /usr/share/info/*" >> /etc/dpkg/dpkg.cfg.d/01_nodoc
  sudo echo "path-exclude /usr/share/lintian/*" >> /etc/dpkg/dpkg.cfg.d/01_nodoc
  sudo echo "path-exclude /usr/share/linda/*" >> /etc/dpkg/dpkg.cfg.d/01_nodoc
  sudo find /usr/share/doc -depth -type f ! -name copyright|xargs rm || true
  sudo find /usr/share/doc -empty|xargs rmdir || true
  sudo rm -rf /usr/share/man /usr/share/groff /usr/share/info /usr/share/lintian /usr/share/linda /var/cache/man

  sudo apt-get update -qq
  
  # https://github.com/cben/wercker-box-ubuntu14.04-latex/blob/master/wercker-box.yml
  # Install texlive-full except for *-doc packages.
  sudo apt-get install -y $(apt-cache depends texlive-full | sed -n -e 's/-doc$/-doc-/' -e 's/ *Depends: //p') biber make latexmk
